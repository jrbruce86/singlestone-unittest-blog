<!DOCTYPE html>
<!-- saved from url=(0052)https://www.singlestoneconsulting.com/blog/software/ -->
<html lang="en-US" class="js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  <script type="text/javascript" async="" src="./SingleStone&#39;s Software Expertise_files/linkid.js"></script><script type="text/javascript" async="" src="./SingleStone&#39;s Software Expertise_files/analytics.js"></script><script async="" src="./SingleStone&#39;s Software Expertise_files/gtm.js"></script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WL9K2W');</script> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="profile" href="http://gmpg.org/xfn/11"> <script>document.documentElement.className = document.documentElement.className.replace('no-js', 'js');</script> <link type="text/css" media="all" href="./SingleStone&#39;s Software Expertise_files/autoptimize_dac803396a4ebdcaa217e01e8428418f.css" rel="stylesheet"><link type="text/css" media="screen" href="./SingleStone&#39;s Software Expertise_files/autoptimize_8a2466b567beaa5b669cdd9b5714c1b0.css" rel="stylesheet"><title>Writing Unit Tests That Change How You Think About Your Code</title><meta name="description" content="We work with you to design, build, and implement the tech solutions that move you forward with cloud-first software development."><meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"><link rel="canonical" href="https://www.singlestoneconsulting.com/blog/software/"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Writing Unit Tests That Change How You Think About Your Code"><meta property="og:description" content="We work with you to design, build, and implement the tech solutions that move you forward with cloud-first software development."><meta property="og:url" content="https://www.singlestoneconsulting.com/blog/software/"><meta property="og:site_name" content="SingleStone"><meta property="article:section" content="Software"><meta property="article:published_time" content="2019-11-01T13:04:04+00:00"><meta property="article:modified_time" content="2019-11-01T14:41:25+00:00"><meta property="og:updated_time" content="2019-11-01T14:41:25+00:00"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="We work with you to design, build, and implement the tech solutions that move you forward with cloud-first software development."><meta name="twitter:title" content="Writing Unit Tests That Change How You Think About Your Code"><meta name="twitter:image" content="http://singlestone.wpengine.com/wp-content/uploads/2019/10/icon2.svg"> <script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.singlestoneconsulting.com/#website","url":"https://www.singlestoneconsulting.com/","name":"SingleStone","potentialAction":{"@type":"SearchAction","target":"https://www.singlestoneconsulting.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://www.singlestoneconsulting.com/blog/software/#primaryimage","url":"http://singlestone.wpengine.com/wp-content/uploads/2019/10/icon2.svg"},{"@type":"WebPage","@id":"https://www.singlestoneconsulting.com/blog/software/#webpage","url":"https://www.singlestoneconsulting.com/blog/software/","inLanguage":"en-US","name":"Writing Unit Tests That Change How You Think About Your Code","isPartOf":{"@id":"https://www.singlestoneconsulting.com/#website"},"primaryImageOfPage":{"@id":"https://www.singlestoneconsulting.com/blog/software/#primaryimage"},"datePublished":"2019-11-01T13:04:04+00:00","dateModified":"2019-11-01T14:41:25+00:00","author":{"@id":"https://www.singlestoneconsulting.com/#/schema/person/219589bbaed46ab2cb314de2d7093da6"},"description":"We work with you to design, build, and implement the tech solutions that move you forward with cloud-first software development."},{"@type":["Person"],"@id":"https://www.singlestoneconsulting.com/#/schema/person/219589bbaed46ab2cb314de2d7093da6","name":"Gray Hollins","image":{"@type":"ImageObject","@id":"https://www.singlestoneconsulting.com/#authorlogo","url":"https://www.singlestoneconsulting.com/wp-content/uploads/2019/10/Hollins_Gray_Head-Crop.jpg","caption":"Gray Hollins"},"description":"Gray Hollins, our Software Solution Lead, firmly believes that your organization\u2019s approach to technology determines whether or not your systems serve as an anchor or an accelerator. He leads a talented team that create high-performing software to support our clients\u2019 business goals. In his spare time, he's a busy family man, sports fan and bass guitarist in original Americana bands.","sameAs":[]}]}</script> <link rel="dns-prefetch" href="https://unpkg.com/"><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com/"><link rel="dns-prefetch" href="https://s.w.org/"><link rel="alternate" type="application/rss+xml" title="SingleStone » Feed" href="https://www.singlestoneconsulting.com/feed/"><link rel="alternate" type="application/rss+xml" title="SingleStone » Comments Feed" href="https://www.singlestoneconsulting.com/comments/feed/"><link rel="alternate" type="application/rss+xml" title="SingleStone » SingleStone’s Software Expertise Comments Feed" href="https://www.singlestoneconsulting.com/blog/software/feed/"> <script type="text/javascript">window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.singlestoneconsulting.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.4"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);</script><script src="./SingleStone&#39;s Software Expertise_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script> <style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/wp-polyfill.min.js"></script> <script type="text/javascript">( 'fetch' in window ) || document.write( '<script src="https://www.singlestoneconsulting.com/wp-includes/js/dist/vendor/wp-polyfill-fetch.min.js?ver=3.0.0"></scr' + 'ipt>' );( document.contains ) || document.write( '<script src="https://www.singlestoneconsulting.com/wp-includes/js/dist/vendor/wp-polyfill-node-contains.min.js?ver=3.26.0-0"></scr' + 'ipt>' );( window.FormData && window.FormData.prototype.keys ) || document.write( '<script src="https://www.singlestoneconsulting.com/wp-includes/js/dist/vendor/wp-polyfill-formdata.min.js?ver=3.0.12"></scr' + 'ipt>' );( Element.prototype.matches && Element.prototype.closest ) || document.write( '<script src="https://www.singlestoneconsulting.com/wp-includes/js/dist/vendor/wp-polyfill-element-closest.min.js?ver=2.0.2"></scr' + 'ipt>' );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/autop.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/blob.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/block-serialization-default-parser.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/lodash.min.js"></script> <script type="text/javascript">window.lodash = _.noConflict();</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/react.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/react-dom.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/escape-html.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/element.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/is-shallow-equal.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/compose.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/priority-queue.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/redux-routine.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/data.min.js"></script> <script type="text/javascript">( function() {
	var userId = 0;
	var storageKey = "WP_DATA_USER_" + userId;
	wp.data
		.use( wp.data.plugins.persistence, { storageKey: storageKey } )
		.use( wp.data.plugins.controls );
	wp.data.plugins.persistence.__unstableMigrate( { storageKey: storageKey } );
} )();</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/dom.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/hooks.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/html-entities.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/i18n.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/shortcode.min.js"></script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", { "locale_data": { "messages": { "": {} } } } );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/blocks.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/url.min.js"></script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", { "locale_data": { "messages": { "": {} } } } );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/api-fetch.min.js"></script> <script type="text/javascript">( function() {
	var nonceMiddleware = wp.apiFetch.createNonceMiddleware( "184fd707d0" );
	wp.apiFetch.use( nonceMiddleware );
	wp.hooks.addAction(
		"heartbeat.tick",
		"core/api-fetch/create-nonce-middleware",
		function( response ) {
			if ( response[ "rest_nonce" ] ) {
				nonceMiddleware.nonce = response[ "rest_nonce" ];
			}
		}
	);
} )();
wp.apiFetch.use( wp.apiFetch.createRootURLMiddleware( "https://www.singlestoneconsulting.com/wp-json/" ) );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/jquery.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/moment.min.js"></script> <script type="text/javascript">moment.locale( 'en_US', {"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"week":{"dow":1},"longDateFormat":{"LT":"g:i a","LTS":null,"L":null,"LL":"F j, Y","LLL":"F j, Y g:i a","LLLL":null}} );</script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", { "locale_data": { "messages": { "": {} } } } );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/keycodes.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/rich-text.min.js"></script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", { "locale_data": { "messages": { "": {} } } } );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/components.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/deprecated.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/core-data.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/token-list.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/viewport.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/wordcount.min.js"></script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", { "locale_data": { "messages": { "": {} } } } );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/block-editor.min.js"></script><style></style> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/date.min.js"></script> <script type="text/javascript">wp.date.setSettings( {"l10n":{"locale":"en_US","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysShort":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"},"relative":{"future":"%s from now","past":"%s ago"}},"formats":{"time":"g:i a","date":"F j, Y","datetime":"F j, Y g:i a","datetimeAbbreviated":"M j, Y g:i a"},"timezone":{"offset":-5,"string":"America\/New_York"}} );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/notices.min.js"></script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", { "locale_data": { "messages": { "": {} } } } );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/nux.min.js"></script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", { "locale_data": { "messages": { "": {} } } } );</script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/editor.min.js"></script> <link rel="https://api.w.org/" href="https://www.singlestoneconsulting.com/wp-json/"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.singlestoneconsulting.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.singlestoneconsulting.com/wp-includes/wlwmanifest.xml"><link rel="shortlink" href="https://www.singlestoneconsulting.com/?p=196"><link rel="alternate" type="application/json+oembed" href="https://www.singlestoneconsulting.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.singlestoneconsulting.com%2Fblog%2Fsoftware%2F"><link rel="alternate" type="text/xml+oembed" href="https://www.singlestoneconsulting.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.singlestoneconsulting.com%2Fblog%2Fsoftware%2F&amp;format=xml"><link rel="pingback" href="https://www.singlestoneconsulting.com/xmlrpc.php"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="SingleStone - Technology for a new kind of business."><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><link rel="icon" type="image/png" href="https://www.singlestoneconsulting.com/wp-content/uploads/2019/11/favicon-32x32.png"></head><body class="post-template-default single single-post postid-196 single-format-standard wp-embed-responsive group-blog" data-aos-easing="ease" data-aos-duration="1000" data-aos-delay="0"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WL9K2W"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="siteWrapper"><header id="siteHeader" class="navbar-light"> <a class="skip-link sr-only sr-only-focusable" href="https://www.singlestoneconsulting.com/blog/software/#main">Skip to content</a><nav class="navbar navbar-expand-md " role="navigation"> <a class="navbar-brand" href="https://www.singlestoneconsulting.com/" title="SingleStone" rel="home"> <img src="./SingleStone&#39;s Software Expertise_files/logo_primary-1.svg" class="attachment-full size-full" alt="SingleStone" height="131" width="535"> </a><div id="navbarCollapse" class="navbar-collapse flex-column align-items-end"><div id="primaryNav" class="mainnav flex-row"><ul id="main-menu" class="navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-48" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-48 nav-item"><a title="Blog" href="https://www.singlestoneconsulting.com/ripple/" class="nav-link">Blog</a></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-114" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-114 nav-item"><a title="Careers" href="https://www.singlestoneconsulting.com/careers/" class="nav-link">Careers</a></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-49" class="popcontact menu-item menu-item-type-custom menu-item-object-custom menu-item-49 nav-item"><a title="Contact" href="https://www.singlestoneconsulting.com/blog/software/#" class="nav-link">Contact</a></li></ul></div></div></nav></header><main id="main" role="main" class="blog-single-main"><div id="hero" class="default-hero aos-init aos-animate" data-aos="fade" data-aos-duration="1400"><div class="container container-small"><div class="hero-headline aos-init aos-animate" data-aos="zoom-in" data-aos-delay="300" data-aos-duration="1000"><h1>Writing Unit Tests That Change How You Think About Your Code</h1><h2>A Developer Series</h2></div></div></div><section id="main-content" class="section"><div class="container container-medium"><article class="post-196 post type-post status-publish format-standard hentry category-featured category-software" id="post-196"><header class="entry-header"> <span class="posted-on"><time class="entry-date published" datetime="2019-11-01T09:04:04-05:00">November 1, 2019</time></span><span class="author-name">by <a class="url fn n" href="https://www.singlestoneconsulting.com/blog/author/ghollins/"> Jake Bruce</a></span><ul class="social-list list-inline author-social"></ul></header><p class="entry-content"><p>Unit testing can be a valuable technique for code verification, analysis, regression testing, and documentation. They are a cost effective way to ensure all of the paths of your code are exercised and run as you intend early on in the development process. This blog series will demonstrate unit tests written for a real application. The application demonstrated here is a simple API that allows for storage and lookup of customer purchases for some franchise.</p><div class="wp-block-image"><figure class="alignright"><img src="./SingleStone&#39;s Software Expertise_files/icon2.svg" alt="SIngleStone Software Solution" class="wp-image-59"></figure></div><h2>Requirements for a Customer Purchase Inventory Tracking API</h2><h3>Below is the specification of what the API demonstrated in this example must support through its endpoints:  </h3> <p> 1. Storage and retrieval of each customer purchase. <br>2. Retrieve full list of customers <br>3. Retrieve purchase history for a customer ranked by total spent <br>4. Retrieve total amount spent by a customer. </p> <h2> Implementation and Test for Customer Purchase Scenarios </h2> <p> The functionality above is implemented in a single <a href="https://github.com/jrbruce86/singlestone-unittest-blog/blob/master/src/main/java/jake/blog/inventoryApi/controllers/StoreInventoryController.java"> java class</a>. The scenarios we will cover in this blog involve the implementation and unit tests for making a purchase. See below for the implementation of the method I will be testing: </p>

    <!-- BEGIN SOURCE CODE BLOCK -->
<div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 15px"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5
6
7</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #a6e22e">@PostMapping</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;/purchase&quot;</span><span style="color: #f92672">)</span>
<span style="color: #66d9ef">public</span> <span style="color: #f8f8f2">PurchaseRecord</span> <span style="color: #a6e22e">purchase</span><span style="color: #f92672">(</span><span style="color: #66d9ef">final</span> <span style="color: #a6e22e">@RequestBody</span> <span style="color: #f8f8f2">InboundPurchaseRecordDTO</span> <span style="color: #f8f8f2">purchaseRecordDTO</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
    <span style="color: #66d9ef">if</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">findById</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordDTO</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getCustomerID</span><span style="color: #f92672">()).</span><span style="color: #a6e22e">isEmpty</span><span style="color: #f92672">())</span> <span style="color: #f92672">{</span>
        <span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">Customer</span><span style="color: #f92672">().</span><span style="color: #a6e22e">setCustomerID</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordDTO</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getCustomerID</span><span style="color: #f92672">()));</span>
    <span style="color: #f92672">}</span>
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">.</span><span style="color: #a6e22e">toPurchaseRecord</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordDTO</span><span style="color: #f92672">));</span>
<span style="color: #f92672">}</span>
</pre></td></tr></table></div>

    <!-- END SOURCE CODE BLOCK -->
    <br>
    <p> Note that in the above method, given the single if statement, there are two possible branches to be tested. In this blog we will demonstrate how to test and verify the correct behavior in both of these branches. </p> <p> For the unit tests I use the <a href="http://xunitpatterns.com/JUnit.html">JUnit Automated Test Framework </a> and follow the <a href="http://xunitpatterns.com/Delegated%20Setup.html"> Delegated Setup Pattern </a> which involves recreating the object being tested from scratch during the beginning of each individual test. Each test that is run has <a href="http://xunitpatterns.com/Four%20Phase%20Test.html">four phases</a>: setup, exercise, verify, and teardown. For the two scenarios in the above code, we will go over each of these four steps in turn. </p><p>Below is the full unit test that was written for the scenario where the if statement is entered (the customer's initial purchase): </p>

    <!-- BEGIN SOURCE CODE BLOCK -->
    <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 13px"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #a6e22e">@Test</span>
<span style="color: #66d9ef">public</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">customerInitialPurchaseSuccessful</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
    <span style="color: #75715e">/**</span>
<span style="color: #75715e">     * Setup</span>
<span style="color: #75715e">     */</span>
    <span style="color: #75715e">// stub the customer lookup to simulate non existing customer</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">findById</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">Optional</span><span style="color: #f92672">.</span><span style="color: #a6e22e">empty</span><span style="color: #f92672">());</span>

    <span style="color: #75715e">// stub the dto mapper operation return the expect result</span>
    <span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">PurchaseRecord</span> <span style="color: #f8f8f2">expectedResult</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">mock</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">PurchaseRecord</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">.</span><span style="color: #a6e22e">toPurchaseRecord</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>

    <span style="color: #75715e">// stub the save operation to save successfully returning saved result</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>

    <span style="color: #75715e">/**</span>
<span style="color: #75715e">     * Exercise</span>
<span style="color: #75715e">     */</span>
    <span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">PurchaseRecord</span> <span style="color: #f8f8f2">actualResult</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">objectUnderTest</span><span style="color: #f92672">.</span><span style="color: #a6e22e">purchase</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">);</span>

    <span style="color: #75715e">/**</span>
<span style="color: #75715e">     * Verify</span>
<span style="color: #75715e">     */</span>
    <span style="color: #f8f8f2">Assertions</span><span style="color: #f92672">.</span><span style="color: #a6e22e">assertTrue</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">actualResult</span><span style="color: #f92672">,</span> <span style="color: #e6db74">&quot;The returned result does not match the expected result&quot;</span><span style="color: #f92672">);</span>
    <span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">ArgumentCaptor</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">Customer</span><span style="color: #f92672">&gt;</span> <span style="color: #f8f8f2">expectedSavedCustomer</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ArgumentCaptor</span><span style="color: #f92672">.</span><span style="color: #a6e22e">forClass</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">Customer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedSavedCustomer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">capture</span><span style="color: #f92672">());</span>
    <span style="color: #f8f8f2">Assertions</span><span style="color: #f92672">.</span><span style="color: #a6e22e">assertEquals</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedSavedCustomer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getValue</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getCustomerID</span><span style="color: #f92672">(),</span> <span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">findById</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">toPurchaseRecord</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>
<span style="color: #f92672">}</span>
</pre></td></tr></table></div>
    <!-- END SOURCE CODE BLOCK -->
<br>
    <p> Note that the method for the above unit test is named based on a concise description of the scenario we are testing (customerInitialPurchaseSuccessful). Above the "Setup", "Exercise", and "Verify" sections of the code are denoted by their respective comments. Also note that the "Teardown" section is omitted in this case since the Java language includes a <a href="http://xunitpatterns.com/Garbage-Collected%20Teardown.html">garbage collector</a> which implicitly handles this step by removing all objects in the method as they go out of scope. The remaining steps of the unit tests are covered below in more detail:</p>
    <h2>Setup</h2><p>We first need to instantiate the object being tested. Since all tests will require this step I have moved the logic into a function annotated with @BeforeEach which informs Junit to run this function before each test. In this setup step we invoke the tested object's constructor by passing mocks of each dependency (line 8). These mock versions of the dependencies are created using the  <a href="https://site.mockito.org/">Mockito Framework</a> and through the use of various Mockito functions such as "when" on we can tell these dependencies to behave in ways that will allow us to exercise the paths of code that need to be tested.</p>

    <!-- BEGIN SOURCE CODE BLOCK -->
    <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 15px"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #a6e22e">@BeforeEach</span>
<span style="color: #66d9ef">public</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">setup</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
    <span style="color: #f8f8f2">purchaseRecordRepository</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">mock</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">PurchaseRecordRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">storeItemRepository</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">mock</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">StoreItemRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">customerRepository</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">mock</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">CustomerRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">dtoMapper</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">mock</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DtoMapper</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>

    <span style="color: #f8f8f2">objectUnderTest</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">StoreInventoryController</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">,</span>
            <span style="color: #f8f8f2">storeItemRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">);</span>

    <span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">initialize</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">storeItemRepository</span><span style="color: #f92672">);</span>
<span style="color: #f92672">}</span>
</pre></td></tr></table></div>


    <!-- END SOURCE CODE BLOCK -->

    <br>
    <p> With the object being tested instantiated as shown above, I am now in a position where I can test the initial purchase in isolation by stubbing the behaviors of the mocks as shown in the Setup section of the unit test below: </p>

    <!-- BEGIN SOURCE CODE BLOCK -->
    <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;font-size: 15px"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #75715e">/**</span>
<span style="color: #75715e"> * Setup</span>
<span style="color: #75715e"> */</span>
<span style="color: #75715e">// stub the customer lookup to simulate non existing customer</span>
<span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">findById</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">Optional</span><span style="color: #f92672">.</span><span style="color: #a6e22e">empty</span><span style="color: #f92672">());</span>

<span style="color: #75715e">// stub the dto mapper operation return the expect result</span>
<span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">PurchaseRecord</span> <span style="color: #f8f8f2">expectedResult</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">mock</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">PurchaseRecord</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
<span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">.</span><span style="color: #a6e22e">toPurchaseRecord</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>

<span style="color: #75715e">// stub the save operation to save successfully returning saved result</span>
<span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>
</pre></td></tr></table></div>
    <!-- END SOURCE CODE BLOCK-->

    <br>
    By manipulating the behavior of the dependency mocks as follows I can set up my test to run through the correct branch in a controlled manner. On line 5 just above, I tell the customer lookup operation that it will indicate there is no existing customer so that the purchase method's "if" statement will be entered as expected. I then tell a method that translates the purchase input into a database object to return one that I have defined for my test (line 9 above). And lastly I stub the save operation itself to also return that object as if it was saved correctly (line 12 above). Next I will cover what happens when the tested method is exercised with these mocks in place. </p><h2>Exercise</h2><p>Now, when the purchase method is exercised as shown below, </p>

    <!-- BEGIN SOURCE CODE BLOCK -->
        <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;font-size:15px"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #75715e">/**</span>
<span style="color: #75715e"> * Exercise</span>
<span style="color: #75715e"> */</span>
<span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">PurchaseRecord</span> <span style="color: #f8f8f2">actualResult</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">objectUnderTest</span><span style="color: #f92672">.</span><span style="color: #a6e22e">purchase</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">);</span>
</pre></td></tr></table></div>

    <!-- END SOURCE CODE BLOCK -->

<br>
    <p>we can verify that the correct path of code was executed or not. We can do so by running the test and leveraging our <a href="https://docs.gradle.org/current/userguide/jacoco_plugin.html">code coverage tool</a> whose output is illustrated below.</p>
    <br>
    <img src="./initialpurchasecoverage.png" width="100%" style="border-width:50x;border-style:solid">
    <br><br>
    <p>Notice that the path we are executing in our test is green, the yellow shows that only 1 of 2 branches in the if statement have been run so far, the red shows paths that have not been tested.</p><h2>Verify:</h2><p>While the code coverage tool does confirm that the code path of the scenario is run, it cannot confirm that any of the tested code behaved in a controlled way. When looking closely at the implementation of the branch we are testing we will notice that it doesn't do much itself, rather it is mostly a pass-through method that delegates responsibilities to the dependencies. The CustomerRepository findById method takes the customer id and returns an empty value, the CustomerRepository save method saves the provided customer id into the table, the DtoMapper toPurchaseRecord method translates the input into a <a href="https://spring.io/projects/spring-data-jpa">Spring JPA</a> database object, the database object is passed into the PurchaseRecordRepository save method and returned by it, and finally the function exits returning the output of the output of the save method. Using the Mockito "verify" along with "ArgumentCaptor" we ensure all of the behavior occurred as expected as demonstrated below: </p>


    <!-- BEGIN SOURCE CODE BLOCK -->
    <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;font-size: 14px"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #75715e">/**</span>
<span style="color: #75715e"> * Verify</span>
<span style="color: #75715e"> */</span>
<span style="color: #f8f8f2">Assertions</span><span style="color: #f92672">.</span><span style="color: #a6e22e">assertTrue</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">actualResult</span><span style="color: #f92672">,</span> <span style="color: #e6db74">&quot;The returned result does not match the expected result&quot;</span><span style="color: #f92672">);</span>
<span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">ArgumentCaptor</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">Customer</span><span style="color: #f92672">&gt;</span> <span style="color: #f8f8f2">expectedSavedCustomer</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ArgumentCaptor</span><span style="color: #f92672">.</span><span style="color: #a6e22e">forClass</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">Customer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
<span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedSavedCustomer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">capture</span><span style="color: #f92672">());</span>
<span style="color: #f8f8f2">Assertions</span><span style="color: #f92672">.</span><span style="color: #a6e22e">assertEquals</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedSavedCustomer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getValue</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getCustomerID</span><span style="color: #f92672">(),</span> <span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">);</span>
<span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">findById</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">);</span>
<span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">toPurchaseRecord</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">);</span>
<span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>
</pre></td></tr></table></div>
<!-- END SOURCE CODE BLOCK -->

    <br>
    <p>In the above verification, we start by making sure that the actual returned reference matches the expected one (line 4 above).  Since, as mentioned earlier, the method being tested just passes this object around we don't need to verify the contents of the result in this test. However, we do need to verify that the method delegated responsibilities correctly. In line 6 above, we make sure that the if statement was entered by ensuring the CustomerRepository save method was called once and we also record the input that had been passed into it so that we can verify it is the correctly value in line 7 above. In line 8 we verify that the CustomerRepository findById method was called with the correct input during the if statement. In lines 9 and 10 above we then verify that the DtoMapper translation and PurchaseRecordRepository save methods were called with the correct arguments respectively. With this verification in place, the test will no longer pass if any of the expected behaviors are modified. This can not only help us verify our code works as expected during development to resolve bugs early, but also prevent future developers from modifiying this expected behavior later on without first thinking about the impacts to the legacy features. </p>


    <h2>Testing the Other Branch</h2><p>Testing the second branch of code (where the if statement is passed over) only requires some slight alterations to the previous test. Namely, the CustomerRepository findById() method must now return a non-empty record and we must verify that the customer record is now not saved as shown below: </p>

    <!-- BEGIN SOURCE CODE BLOCK -->
    <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;font-size: 11px"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #a6e22e">@Test</span>
<span style="color: #66d9ef">public</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">customerSubsequentPurchaseSuccessful</span><span style="color: #f92672">()</span> <span style="color: #f92672">{</span>
    <span style="color: #75715e">/**</span>
<span style="color: #75715e">     * Setup</span>
<span style="color: #75715e">     */</span>
    <span style="color: #75715e">// stub the customer lookup to simulate existing customer</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">findById</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">Optional</span><span style="color: #f92672">.</span><span style="color: #a6e22e">of</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomer</span><span style="color: #f92672">));</span>

    <span style="color: #75715e">// stub the dto mapper operation to return the expected result</span>
    <span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">PurchaseRecord</span> <span style="color: #f8f8f2">expectedResult</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">mock</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">PurchaseRecord</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">.</span><span style="color: #a6e22e">toPurchaseRecord</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>

    <span style="color: #75715e">// stub the save operation to save successfully returning the saved result</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">when</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">.</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">thenReturn</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>

    <span style="color: #75715e">/**</span>
<span style="color: #75715e">     * Exercise</span>
<span style="color: #75715e">     */</span>
    <span style="color: #66d9ef">final</span> <span style="color: #f8f8f2">PurchaseRecord</span> <span style="color: #f8f8f2">actualResult</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">objectUnderTest</span><span style="color: #f92672">.</span><span style="color: #a6e22e">purchase</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">);</span>

    <span style="color: #75715e">/**</span>
<span style="color: #75715e">     * Verify</span>
<span style="color: #75715e">     */</span>
    <span style="color: #f8f8f2">Assertions</span><span style="color: #f92672">.</span><span style="color: #a6e22e">assertTrue</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">actualResult</span><span style="color: #f92672">,</span> <span style="color: #e6db74">&quot;The returned result does not match the expected result&quot;</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">purchaseRecordRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">expectedResult</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">findById</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultCustomerID1</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">dtoMapper</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">times</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">)).</span><span style="color: #a6e22e">toPurchaseRecord</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">DefaultStoreValues</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultInboundCustomerPurchase</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">verify</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">customerRepository</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">never</span><span style="color: #f92672">()).</span><span style="color: #a6e22e">save</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">Mockito</span><span style="color: #f92672">.</span><span style="color: #a6e22e">any</span><span style="color: #f92672">());</span>
<span style="color: #f92672">}</span>
</pre></td></tr></table></div>

    <!-- END SOURCE CODE BLOCK -->
    <br>
    <p> Now when we run the test, the code coverage tool reveals that we have completely covered all paths of this function as shown below: </p>
    <p><img src="./1.2coverage.png" width="100%" style="border-width:50x;border-style:solid"></p>
    <p>We can make sure the verification is correct in both of these scenarios by purposefully breaking some of the functionality and ensuring the unit test now breaks where it didn't before.</p><h2>Conclusion:</h2><p>In this blog we have walked through the implementation of and tests for a very simple endpoint in an API for storing and retrieving customer records. In the next blog we will walk through more complex functionality that allows verifying the API can successfully keep track of the purchases.</p></article></div><div id="author-box" class="section"><div class="container container-medium"><div class="row"><div class="col-sm-3"> <!--<img src="./SingleStone&#39;s Software Expertise_files/Hollins_Gray_Head-Crop-660x660.jpg" width="250" height="250" alt="Gray Hollins" class="avatar avatar-250 wp-user-avatar wp-user-avatar-250 alignnone photo">--></div><div class="col-sm-9"><h3 class="author-box-name"> Jake Bruce </h3><ul class="social-list list-inline author-social"></ul><p>TODO brief description of Jake Bruce </p><div class="author-contacts"><p><a class="btn btn-sm btn-secondary" href="mailto:jbruce@singlestoneconsulting.com"> Contact Me</a> <a class="btn btn-sm btn-primary" href="https://www.singlestoneconsulting.com/blog/author/jbruce/"> View My Posts </a></p></div></div></div></div></div><div class="container container-medium"><div class="comments-area" id="comments"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://www.singlestoneconsulting.com/blog/software/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://www.singlestoneconsulting.com/wp-comments-post.php?wpe-comment-post=singlestone" method="post" id="commentform" class="comment-form" novalidate=""><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><div class="form-group comment-form-comment"><textarea class="form-control" id="comment" name="comment" placeholder="Comment" aria-required="true" cols="45" rows="8"></textarea></div><div class="form-group comment-form-author"><input class="form-control" id="author" name="author" type="text" placeholder="Your name" value="" size="30" aria-required="true"></div><div class="form-group comment-form-email"><input class="form-control" id="email" placeholder="Email address" name="email" type="email" value="" size="30" aria-required="true"></div><p class="form-submit"><input name="submit" type="submit" id="submit" class="btn btn-secondary" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="196" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f3871fb9a7"></p><p style="display: none;"></p><input type="hidden" id="ak_js" name="ak_js" value="1576861026241"></form></div></div></div></section><section id="related-posts" class="section waves-combo"><div class="container container-medium"><header class="section-header"><h2>Related Insights</h2></header><div class="card-deck"><article class="blog-card card aos-init" id="post-259" data-aos="fade-up"><div class="card-body"> <a href="https://www.singlestoneconsulting.com/blog/culture-shock-build-a-great-place-to-work/" class="card-link" aria-label="Culture Shock: 5 Simple Steps to Building a Great Place to Work."></a><h3 class="entry-title"> <a href="https://www.singlestoneconsulting.com/blog/culture-shock-build-a-great-place-to-work/" title="Culture Shock: 5 Simple Steps to Building a Great Place to Work." rel="bookmark">Culture Shock: 5 Simple Steps to Building a Great Place to Work.</a></h3> <span class="author-name">by <a class="url fn n" href="https://www.singlestoneconsulting.com/blog/author/trhodes/"> Tricia Rhodes</a></span><hr><div class="entry-excerpt-wrapper"><div class="entry-excerpt"><p>A great company culture starts with authenticity and personal relationships. Tear down the cubicles, buy a treadmill desk, ask your CEO to wear jeans and there you have…</p></div></div></div><div class="card-footer"> <a class="btn btn-sm btn-secondary read-more-link" href="https://www.singlestoneconsulting.com/blog/culture-shock-build-a-great-place-to-work/" title="Culture Shock: 5 Simple Steps to Building a Great Place to Work." rel="bookmark"> Read More </a></div></article><article class="blog-card card aos-init" id="post-201" data-aos="fade-up"><div class="card-body"> <a href="https://www.singlestoneconsulting.com/blog/evolution/" class="card-link" aria-label="SingleStone’s Evolution"></a><h3 class="entry-title"> <a href="https://www.singlestoneconsulting.com/blog/evolution/" title="SingleStone’s Evolution" rel="bookmark">SingleStone’s Evolution</a></h3> <span class="author-name">by <a class="url fn n" href="https://www.singlestoneconsulting.com/blog/author/jchou/"> Jimmy Chou</a></span><hr><div class="entry-excerpt-wrapper"><div class="entry-excerpt"><p>In 2006, I joined SingleStone with one simple goal: demonstrate how consulting can be done differently. I have always loved solving problems across organizations, from my early career…</p></div></div></div><div class="card-footer"> <a class="btn btn-sm btn-secondary read-more-link" href="https://www.singlestoneconsulting.com/blog/evolution/" title="SingleStone’s Evolution" rel="bookmark"> Read More </a></div></article><article class="blog-card card aos-init" id="post-188" data-aos="fade-up"><div class="card-body"> <a href="https://www.singlestoneconsulting.com/blog/product-teaminsights/" class="card-link" aria-label="SingleStone’s Product Expertise"></a><h3 class="entry-title"> <a href="https://www.singlestoneconsulting.com/blog/product-teaminsights/" title="SingleStone’s Product Expertise" rel="bookmark">SingleStone’s Product Expertise</a></h3> <span class="author-name">by <a class="url fn n" href="https://www.singlestoneconsulting.com/blog/author/pnichols/"> Prescott Nichols</a></span><hr><div class="entry-excerpt-wrapper"><div class="entry-excerpt"><p>We live in a world of immediacy.&nbsp;&nbsp;Do you want a very-berry&nbsp;peanut butter smoothie?&nbsp;&nbsp;Just click “yes” on your favorite mobile app, and it will be at your doorstep in…</p></div></div></div><div class="card-footer"> <a class="btn btn-sm btn-secondary read-more-link" href="https://www.singlestoneconsulting.com/blog/product-teaminsights/" title="SingleStone’s Product Expertise" rel="bookmark"> Read More </a></div></article></div></div></section></main><footer id="siteFooter" class="section text-white"><div class="container"><div class="row"><div class="col-md-4 footer-col"><div id="footerNav" class="footernav"><ul id="footer-menu" class="navbar-nav"><li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-50"><a href="https://www.singlestoneconsulting.com/">Home</a></li><li id="menu-item-115" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-115"><a href="https://www.singlestoneconsulting.com/careers/">Careers</a></li><li id="menu-item-52" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-52"><a href="https://www.singlestoneconsulting.com/ripple/">Blog</a></li><li id="menu-item-53" class="popcontact menu-item menu-item-type-custom menu-item-object-custom menu-item-53"><a href="https://www.singlestoneconsulting.com/blog/software/#">Contact</a></li></ul></div></div><div class="col-md-4 footer-col text-center"> <a class="footer-phone" href="tel:(877) 334-4266" itemprop="telephone">(877) 334-4266</a><a class="footer-email" href="mailto:(877)%20334-4266" itemprop="email">info@singlestoneconsulting.com</a><p class="footer-address" href="tel:(877) 334-4266" itemprop="address">4101 Cox Road, Suite 350 <br> Glen Allen, Virginia 23060</p></div><div class="col-md-4 footer-col footer-social" itemscope="" itemtype="http://schema.org/Organization"><ul class="social-list list-inline"><li class="list-inline-item"> <a target="_blank" title="Follow us on Twitter" aria-label="Follow us on Twitter" href="https://twitter.com/SingleStoneTech"> <i class="fab fa-twitter" aria-hidden="true"></i> </a></li><li class="list-inline-item"> <a target="_blank" title="Follow us on Facebook" aria-label="Follow us on Facebook" href="https://www.facebook.com/SingleStoneTech"> <i class="fab fa-facebook-f" aria-hidden="true"></i> </a></li><li class="list-inline-item"> <a target="_blank" title="Follow us on LinkedIn" aria-label="Follow us on LinkedIn" href="https://www.linkedin.com/company/singlestone"> <i class="fab fa-linkedin-in" aria-hidden="true"></i></a></li></ul></div></div><div class="footer-legal"><p class="small" style="text-align: center;">© SingleStone 2019. All Rights Reserved. <a href="http://singlestone.wpengine.com/privacy-policy/">Privacy/Legal</a>.</p><p style="text-align: center;">Looking for CRM, CCM, CMS services? Visit <a href="https://www.waypathconsulting.com/">WayPath</a>, a SingleStone Company.</p></div></div></footer><div class="modal fade" id="contact-popup" tabindex="-1" role="dialog" aria-labelledby="popcontact" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">×</span> </button><div class="modal-body"><div class="gf_browser_chrome gform_wrapper" id="gform_wrapper_1"><div id="gf_1" class="gform_anchor" tabindex="-1"></div><form method="post" enctype="multipart/form-data" target="gform_ajax_frame_1" id="gform_1" action="https://www.singlestoneconsulting.com/blog/software/#gf_1"><div class="gform_heading"><h3 class="gform_title">Get in touch.</h3></div><div class="gform_body"><ul id="gform_fields_1" class="gform_fields top_label form_sublabel_below description_below"><li id="field_1_1" class="gfield gfield_contains_required field_sublabel_below field_description_below hidden_label gfield_visibility_visible"><label class="gfield_label" for="input_1_1">Email address<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_email"> <input name="input_1" id="input_1_1" type="email" value="" class="large" tabindex="12" placeholder="Email address" aria-required="true" aria-invalid="false"></div></li><li id="field_1_2" class="gfield gfield_contains_required field_sublabel_below field_description_below hidden_label gfield_visibility_visible"><label class="gfield_label" for="input_1_2">Your message<span class="gfield_required">*</span></label><div class="ginput_container ginput_container_textarea"><textarea name="input_2" id="input_1_2" class="textarea medium" tabindex="13" placeholder="Your message" aria-required="true" aria-invalid="false" rows="10" cols="50"></textarea></div></li><li id="field_1_3" class="gfield gform_validation_container field_sublabel_below field_description_below gfield_visibility_visible"><label class="gfield_label" for="input_1_3">Comments</label><div class="ginput_container"><input name="input_3" id="input_1_3" type="text" value="" autocomplete="off"></div><div class="gfield_description" id="gfield_description__3">This field is for validation purposes and should be left unchanged.</div></li></ul></div><div class="gform_footer top_label"> <button type="submit" onclick="if(window[&quot;gf_submitting_1&quot;]){return false;}  if( !jQuery(&quot;#gform_1&quot;)[0].checkValidity || jQuery(&quot;#gform_1&quot;)[0].checkValidity()){window[&quot;gf_submitting_1&quot;]=true;}  " onkeypress="if( event.keyCode == 13 ){ if(window[&quot;gf_submitting_1&quot;]){return false;} if( !jQuery(&quot;#gform_1&quot;)[0].checkValidity || jQuery(&quot;#gform_1&quot;)[0].checkValidity()){window[&quot;gf_submitting_1&quot;]=true;}  jQuery(&quot;#gform_1&quot;).trigger(&quot;submit&quot;,[true]); }" id="gform_submit_button_1" class="gform_button button">Send</button> <input type="hidden" name="gform_ajax" value="form_id=1&amp;title=1&amp;description=&amp;tabindex=12"> <input type="hidden" class="gform_hidden" name="is_submit_1" value="1"> <input type="hidden" class="gform_hidden" name="gform_submit" value="1"> <input type="hidden" class="gform_hidden" name="gform_unique_id" value=""> <input type="hidden" class="gform_hidden" name="state_1" value="WyJbXSIsIjBmYmQ4OWEzMTRkYTFmOGQ2OGFlMjVhMjIzNmNhZGZhIl0="> <input type="hidden" class="gform_hidden" name="gform_target_page_number_1" id="gform_target_page_number_1" value="0"> <input type="hidden" class="gform_hidden" name="gform_source_page_number_1" id="gform_source_page_number_1" value="1"> <input type="hidden" name="gform_field_values" value=""></div></form></div> <iframe style="display:none;width:0px;height:0px;" src="./SingleStone&#39;s Software Expertise_files/saved_resource.html" name="gform_ajax_frame_1" id="gform_ajax_frame_1" title="Ajax Frame">This iframe contains the logic required to handle Ajax powered Gravity Forms.</iframe> <script type="text/javascript">jQuery(document).ready(function($){gformInitSpinner( 1, 'https://www.singlestoneconsulting.com/wp-content/plugins/gravityforms/images/spinner.gif' );jQuery('#gform_ajax_frame_1').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_1');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_1').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_1').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_1').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_1').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_1').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_1').val();gformInitSpinner( 1, 'https://www.singlestoneconsulting.com/wp-content/plugins/gravityforms/images/spinner.gif' );jQuery(document).trigger('gform_page_loaded', [1, current_page]);window['gf_submitting_1'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_1').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_1').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [1]);window['gf_submitting_1'] = false;}, 50);}else{jQuery('#gform_1').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [1, current_page]);} );} );</script><script type="text/javascript">jQuery(document).bind('gform_post_render', function(event, formId, currentPage){if(formId == 1) {if(typeof Placeholders != 'undefined'){
                        Placeholders.enable();
                    }} } );jQuery(document).bind('gform_post_conditional_logic', function(event, formId, fields, isInit){} );</script><script type="text/javascript">jQuery(document).ready(function(){jQuery(document).trigger('gform_post_render', [1, 1]) } );</script> </div><div class="modal-footer"><div class="container"><h4 itemprop="address">4101 Cox Road, Suite 350 <br> Glen Allen, Virginia 23060</h4><h4><a class="footer-phone" href="tel:(877) 334-4266" itemprop="telephone">(877) 334-4266</a></h4></div></div></div></div></div> <span class="breakpoint-tester"></span> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/isotope.pkgd.min.js"></script> <script type="text/javascript" src="./SingleStone&#39;s Software Expertise_files/jquery.matchHeight-min.js"></script> <script type="text/javascript">var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2},"base_url":"https:\/\/www.singlestoneconsulting.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/www.singlestoneconsulting.com\/wp-content\/plugins\/gravityforms\/images\/spinner.gif"};</script> <script type="text/javascript" defer="" src="./SingleStone&#39;s Software Expertise_files/autoptimize_9ba77632ace0c896813232d3654f0f54.js"></script></div><div id="wp-a11y-speak-polite" aria-live="polite" aria-relevant="additions text" aria-atomic="true" class="screen-reader-text wp-a11y-speak-region"></div><div id="wp-a11y-speak-assertive" aria-live="assertive" aria-relevant="additions text" aria-atomic="true" class="screen-reader-text wp-a11y-speak-region"></div><script type="text/javascript" id="gtm-scroll-tracking">(function(b,g,a){function l(){if(!b.querySelector||!b.body.getBoundingClientRect)return!1;a.dataLayerName=a.dataLayerName||"dataLayer";a.distances=a.distances||{};p();n(g,"scroll",v(p,500))}function q(e,f,c,d,a){var k;for(k=0;k<f.length;k++){var b=parseInt(f[k],10),h="%"!==c?b+a:b/100*d+a;b+=c;h<=d+a&&(e[b]=h)}return e}function r(e,a){var c=parseInt(e,10),d=a/c,f=[],b;for(b=1;b<d+1;b++)f.push(b*c);return f}function p(){var e=t(a.bottom),f=t(a.top),c=b.body,d=b.documentElement;c=Math.max(c.scrollHeight,
c.offsetHeight,d.clientHeight,d.scrollHeight,d.offsetHeight);f&&(c-=f);e&&(c=e-(f||0));e=c-5;f=f||0;c={};d=[];var h=[];if(a.distances.percentages&&(a.distances.percentages.each&&(d=d.concat(a.distances.percentages.each)),a.distances.percentages.every)){var k=r(a.distances.percentages.every,100);d=d.concat(k)}a.distances.pixels&&(a.distances.pixels.each&&(h=h.concat(a.distances.pixels.each)),a.distances.pixels.every&&(k=r(a.distances.pixels.every,e),h=h.concat(k)));c=q(c,d,"%",e,f);e=c=q(c,h,"px",
e,f);f=void 0!==g.pageXOffset;c="CSS1Compat"===(b.compatMode||"");f=f?g.pageYOffset:c?b.documentElement.scrollTop:b.body.scrollTop;f=parseInt(f,10);c=parseInt;d="CSS1Compat"===b.compatMode?b.documentElement:b.body;d=d.clientHeight;f+=c(d,10);for(var m in e)if(f>e[m]&&!u[m])if(u[m]=!0,c=m,d=g.GoogleAnalyticsObject,"undefined"===typeof g[a.dataLayerName]||a.forceSyntax)if("function"===typeof g[d]&&"function"===typeof g[d].getAll&&2!==a.forceSyntax)g[d]("send","event",a.category,c,a.label,{nonInteraction:1});
else"undefined"!==typeof g._gaq&&1!==a.forceSyntax&&g._gaq.push(["_trackEvent",a.category,c,a.label,0,!0]);else g[a.dataLayerName].push({event:"scrollTracking",attributes:{distance:c,label:a.label}})}function t(e){if("number"===typeof e||parseInt(e,10))return parseInt(e,10);try{var a=1===e.nodeType?e:b.querySelector(e),c=b.body.getBoundingClientRect().top,d=Math.floor(a.getBoundingClientRect().top-c);return d}catch(h){}}function v(a,f){var c,d,e,b=null,g=0,l=function(){g=new Date;b=null;e=a.apply(c,
d)};return function(){var h=new Date;g||(g=h);var k=f-(h-g);c=this;d=arguments;0>=k?(clearTimeout(b),b=null,g=h,e=a.apply(c,d)):b||(b=setTimeout(l,k));return e}}function n(a,b,c){if(a.addEventListener)a.addEventListener(b,c);else if(a.attachEvent)a.attachEvent("on"+b,function(b){c.call(a,b)});else if("undefined"===typeof a["on"+b]||null===a["on"+b])a["on"+b]=function(b){c.call(a,b)}}var u={};"loading"!==b.readyState?l():b.addEventListener?n(b,"DOMContentLoaded",l):n(g,"load",l)})(document,window,
{forceSyntax:!1,dataLayerName:!1,distances:{percentages:{each:[10,90],every:25},pixels:{each:[],every:null}},top:null,bottom:null,category:"Scroll Tracking",label:document.location.pathname});</script><script type="text/javascript" id="gtm-vimeo-tracking">(function(g,d,k){function m(){var a=n(r("iframe"),t);a.length&&u(function(){h(a,v)})}function t(a){return-1<a.src.indexOf("player.vimeo.com/video/")}function u(a){l(d.Vimeo)?w("https://player.vimeo.com/api/player.js",a):a()}function v(a){if(!a.__vimeoTracked){a.__vimeoTracked=!0;var c=new Vimeo.Player(a),b=k._track.percentages,e={Play:"play",Pause:"pause","Watch to End":"ended"},f={};c.getVideoTitle().then(function(a){h(["Play","Pause","Watch to End"],function(b){if(k.events[b])c.on(e[b],function(){p(b,
a)})});if(b)c.on("timeupdate",function(e){e=e.percent;for(var c in b)e>=b[c]&&!f[c]&&(f[c]=!0,p(c,a))})})}}function x(a){a=y({},{events:{Play:!0,Pause:!0,"Watch to End":!0},percentages:{each:[],every:[]}},a);h(["each","every"],function(b){var c=a.percentages[b];q(c)||(c=[c]);c&&(a.percentages[b]=z(c,Number))});var c=[].concat(a.percentages.each);a.percentages.every&&h(a.percentages.every,function(a){var b=100/a,e=[],d;for(d=1;d<b;d++)e.push(a*d);c=c.concat(n(e,function(a){return 0<a&&100>a}))});var b=
A(c,function(a,b){a[b+"%"]=b/100;return a},{});a._track={percentages:b};return a}function B(a){a=a||{};var c=a.name||"dataLayer",b=a.name||d.GoogleAnalyticsObject||"ga",e="_gaq",f={gtm:function(a,b){g.push({event:"vimeoTrack",attributes:{videoAction:a,videoName:b}})},cl:function(a,b){d[e].push(["_trackEvent","Videos",a,b])},ua:function(a,c){d[b]("send","event","Videos",a,c)}};switch(a.type){case "gtm":var g=d[c]=d[c]||[];break;case "ua":d[b]=d[b]||function(){(d[b].q=d[b].q||[]).push(arguments)};d[b].l=
+new Date;break;case "cl":d[e]=d[e]||[];break;default:l(d[c])?b&&!l(d[b])?a.type="ua":l(d[e])||l(d[e].push)||(a.type="cl"):(a.type="gtm",g=d[c]=d[c]||[])}return f[a.type]}function y(){var a=[].slice.call(arguments),c=a.shift(),b,e;for(e=0;e<a.length;e++){var d=a[e];for(b in d)c[b]=d[b]}return c}function q(a){return Array.isArray_?Array.isArray_(a):"[object Array]"===Object.prototype.toString.call(a)}function h(a,c){if(Array.prototype.forEach_)return a.forEach.call(a,c);var b;for(b=0;b<a.length;b++)c.call(d,
a[b],b,a)}function z(a,c){if(Array.prototype.map_)return a.map.call(a,c);var b=[];h(a,function(a,f,g){b.push(c.call(d,a,f,g))});return b}function n(a,c){if(Array.prototype.filter)return a.filter.call(a,c);var b=[];h(a,function(a,f,g){c.call(d,a,f,g)&&b.push(a)});return b}function A(a,c,b){if(Array.prototype.reduce)return a.reduce.call(a,c,b);var e;for(e=0;e<a.length;e++){var f=a[e];b=c.call(d,b,f,a,e)}return b}function l(a){return"undefined"===typeof a}function r(a){q(a)||(a=[a]);return[].slice.call(g.querySelectorAll(a.join()))}
function w(a,c){function b(){c&&(c(),f.onload=null)}var d=g.getElementsByTagName("script")[0];var f=g.createElement("script");f.onload=b;f.src=a;f.async=!0;d.parentNode.insertBefore(f,d)}if(!navigator.userAgent.match(/MSIE [678]\./gi)){k=x(k);var p=B(k.syntax);"loading"!==g.readyState?m():g.addEventListener("DOMContentLoaded",m);g.addEventListener("load",m,!0)}})(document,window,{events:{Play:!0,Pause:!0,"Watch to End":!0},percentages:{every:25,each:[10,90]}});</script></body></html>